# 2019.12.24 - разработка бинарного формата


Бинарный формат только для хранения данных. Чтение происходит полностью в память, как и запись - полностью из памяти

Структура дерева хранится в самих данных. При чтении, происходит распарсивание данных

Сами записи хранятся непрерывным списком структур

```
-------------------------
header
-------------------------
entry 1
-------------------------
entry 2
-------------------------
entry n
-------------------------
```


## Запись

- формируем заголовок
- сканируем и накапливаем данные о файлах в памяти
- обновляем заголовок
- создаём бинарные заголовок и секцию с данными
- открываем файл
- записываем заголовок и данные


## Чтение

- открываем файл
- читаем и парсим заголовок
- узнаём о расположении секций
- читаем и парсим список файлов



## Плюсы

+ файл полностью в памяти
+ возможность перезаписи
+ возможность хранения в сжатом виде
+ отсутствие доп. структуры индексов
+ поиск по имени - простой перебор списка файлов


## Минусы

- весь файл в памяти - при большом размере - неэффективно


## Дальнейшие мысли



## Тесты

Запись

^ кол-во файлов ^ размер базы 	^ время создания 	^ сжатый gzip 		 	^ Путь 					^
| 130	 		| 8.3 Kb 		| 0.002 с			| 2.3 Kb 				| Music					|
| 31105 		| 2.1 Mb 		| 1.08 с			| 393.7 Kb 				| Android				|
| 896833 		| 55.3 Mb 		| 36.3 с			| 13.7 Mb 				| Development/_Comcon	|





Чтение gzip

^ кол-во файлов ^ размер базы 	^ время чтения 	^ сжатый gzip 		 	^ Путь 					^
| 896833 		| ---	 		| 5.6 с			| 13.7 Mb 				| Development/_Comcon	|


