# Mcsv

Описание формата Mcsv - v1

Данные хранятся в сжатом(gzip) файле в виде текста.

## Структура документа

Текстовый документ разбит на секции:

- Заголовок - описание тома
- Данные - список записей
- Разделитель - каждая секция разделяется спец. разделителем

Чтение из файла производится по строкам, соответственно - минимальной структурой данных является строка.
Каждая строка должна заканчиваться символом новой строки - **\n**


## Порядок чтения

- Открыть файл на чтение
- Пометить место нахождения - изначально - заголовок
- Начать читать строки одну за другой до разделителя
- Наличие разделителя говорит о смене секции на след.


## Заголовок

Содержит данные, описывающие свойства всего тома в формате ключ:значение

Порядок следование опций - произвольный, что позволит в будующем добавлять новые поля

### Структура

```
	version 	- [int]	- версия формата(в данном случае - 1)
	name 		- [string] - название тома
	description - [string] - описание тома
	created 	- [int] - дата создания(unix timestamp)
	icon 		- [int] - id иконки
```




## Список записей

## Разделитель


## Текущие проблемы

Данные хранятся в текстовом формате.

1. Разбор файла происходит штатным методом readline(), который считывает 1 строку, завершающуюся символом **\n**.
Если в названии или описании есть такой символ - то разбор будет неправильный.

2. Разбор строки на поля происходит разделением строки по спец символу(| или :).
Если в названии или описании есть такой символ - то разбор будет неправильный.

### Возможные решения

1. Заменять спец символы на другие при записи, а при чтении возвращать обратно
2. Кодировать строку в base64

При 1 варианте - увеличивается время выполнения в 4 раза

По размеру оба варианта примерно одинаковые